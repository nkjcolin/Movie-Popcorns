{% extends 'layouts/base.html' %}
{% load static %}
{% block content %}
<div class="content col-12">
    <div class="card card-chart">
        <div class="card-header">
            <div class="row">
                <div class="col-sm-3 text-left">
                    <h5 class="card-category">{{ movieStats.titleID }}</h5>
                    <h2 class="card-title">Title: {{ movieStats.name }}</h2>
                    <h3 class="card-title">Runtime: {{ movieStats.runtime }} mins</h3>
                    <h4 class="card-title">Rating: {{ movieStats.rating }}</h4>
                    <h4 class="card-title">{{ movieStats.votes }} votes</h4>
                </div>
                <div class="col-sm-4 d-flex align-items-center justify-content-center">
                    <div class="row">
                        <div class="col-md-4 d-flex align-items-center justify-content-center">
                            <img src="{{ movieStats.imageSrc }}" class="img-fluid" style="height: 100%; object-fit: contain;">
                        </div>
                        <div class="col-md-6">
                            <video src="{{ movieStats.videoSrc }}" controls autoplay muted style="height: 100%;">
                            </video>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div>
                        <div class="text-center">
                            <h4>{{ movieStats.description }}</h4>
                        </div>                   
                    </div>
                </div>
            </div>
        </div>
    </div>      
    <div class="input-group mb-3">
        <input id="search" type="text" class="form-control" style="height: 55px;" placeholder="Write a review for this movie..." disabled=true>
        <div class="input-group-append">
            <button onclick="toggleReview()" id="watchedBtn" class="btn btn-primary" type="button">Watched</button>
        </div>
    </div>

    {% for reviews in movieReviews %}
    <div class="col-lg-12">
        <div class="card card-chart">
            <div class="card-body">
                <div>
                    <h4>{{ reviews.reviewName }}</h4>
                    <h4>{{ reviews.reviewRating }}/10 
                        {% for _ in reviews.popcornCount %}
                            <img src="https://img.icons8.com/?size=512&id=97192&format=png" style="width: 24px; height: 24px;">
                        {% endfor %}
                    </h4>
                    <h4>{{ reviews.reviewDate }}</h4>
                    <h4>{{ reviews.review }}</h4>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}

</div>

<nav>
    <ul class="pagination justify-content-center pagination pagination-lg">
        <li class="page-item disabled">
            <a class="page-link">Previous</a>
        </li>
        <li class="page-item"><a class="page-link" href="#">1</a></li>
        <li class="page-item"><a class="page-link" href="#">2</a></li>
        <li class="page-item"><a class="page-link" href="#">3</a></li>
        <li class="page-item">
            <a class="page-link" href="#">Next</a>
        </li>
    </ul>
</nav>

<!-- FUNCTION TO SHOOT CONFETTI WHEN USER PRESSES 'Watched' BUTTON-->

<script>
    const defaults = {
        spread: 360,
        ticks: 25,
        gravity: 0,
        decay: 0.94,
        startVelocity: 30,
        shapes: ["star"],
        colors: ["FFE400", "FFBD00", "E89400", "FFCA6C", "FDFFB8"],
    };

    function toggleReview() {
        const textBox = document.getElementById("search");
        const button = document.getElementById("watchedBtn");

        if (button.innerHTML === "Watched") {
                shoot();
        }
        if (textBox.disabled) {
            textBox.disabled = false;
            textBox.placeholder = "Write a review for this movie...";
            button.innerHTML = "Review";
        }
    }

    function shoot() {
        confetti({
            ...defaults,
            particleCount: 500,
            scalar: 1.2,
            shapes: ["star"],
        });

        confetti({
            ...defaults,
            particleCount: 10,
            scalar: 0.75,
            shapes: ["circle"],
        });
    }
</script>

{% endblock content %}